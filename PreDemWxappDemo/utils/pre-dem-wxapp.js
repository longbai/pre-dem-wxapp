!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("./pre-dem-wxapp-conf.js"));else if("function"==typeof define&&define.amd)define(["./pre-dem-wxapp-conf.js"],t);else{var o=t("object"==typeof exports?require("./pre-dem-wxapp-conf.js"):e["./pre-dem-wxapp-conf.js"]);for(var r in o)("object"==typeof exports?exports:e)[r]=o[r]}}("undefined"!=typeof self?self:this,function(e){return function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,o){function r(e,t,o){e[t]?(e[g+t]=e[t],e[t]=((...r)=>{o.call(this,r,t),e[g+t].call(this,...r)})):e[t]=((...e)=>{o.call(this,...e,t)})}const n=o(1);var s,a,i,p,c=!1,u=!1,m=!1;const x="predem_custom_event",d="predem_http_event",l="predem_log_event",f="auto_captured",g="_origin_",y=()=>{S(),b(),k(),setTimeout(y,1e4)},v=(e,t)=>{var o=C();o.type="custom",o.name=e,t&&(o.content=JSON.stringify(t)),w(x,o)},h=e=>{var t=C();t.type=f,t.name="monitor",e&&(t.content=JSON.stringify(e)),w(d,t)},_=e=>{var t=C();t.type=f,t.name="log",e&&(t.content=JSON.stringify(e)),w(l,t)},w=(e,t)=>{wx.getStorage({key:e,success:o=>{let r=o.data;r.push(JSON.stringify(t)),wx.setStorage({key:e,data:r})},fail:()=>{let o=[JSON.stringify(t)];wx.setStorage({key:e,data:o})}})},S=()=>{m||(m=!0,wx.getStorage({key:x,success:function(e){O("custom-events",e.data,()=>{wx.removeStorage({key:x})})},complete:()=>{m=!1}}))},b=()=>{c||(c=!0,wx.getStorage({key:d,success:e=>{O("http-monitors",e.data,()=>{wx.removeStorage({key:d})})},complete:()=>{c=!1}}))},k=()=>{u||(u=!0,wx.getStorage({key:l,success:e=>{O("log-capture",e.data,e=>{wx.removeStorage({key:l})})},complete:()=>{u=!1}}))},O=(e,t,o)=>{let r=t.join("\n");wx.request({url:a+"/v2/"+i+"/"+e,data:r,method:"POST",success:e=>{e.statusCode>=200&&e.statusCode<300&&o(e)}})},j=e=>{var t="",o="";const r=e.split("//");var n;let s=(n=1===r.length?r[0]:r[1]).indexOf("/");return-1==s?t=n:(t=n.substring(0,s),o=n.substring(s,n.length)),{domain:t,path:o}},C=()=>{const e=wx.getSystemInfoSync(),t=getCurrentPages();var o={time:Date.now(),sdk_version:"1.0.0",sdk_id:(()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)})})(),device_model:e.model,mini_program_type:"WeChat",mini_program_version:e.version,mini_program_sdk_version:e.SDKVersion};if(p&&(o.app_version=p),s&&(o.tag=s),0!=t.length){let e=t[t.length-1].route;e&&(o.path=e)}return o};e.exports={setOpenId:e=>{s=e||""},captureCustomEvent:(e,t)=>{v(e,t)},request:e=>{var t={start_timestamp:Date.now()};if(e&&(e.method?t.method=e.method:t.method="GET",e.url)){let o=j(e.url);o&&o.domain&&(t.domain=o.domain),o&&o.path&&(t.path=o.path)}var o=Object.assign({},e);r(o,"success",e=>{t.end_timestamp=Date.now(),t.status_code=e.statusCode,e.data&&(t.data_length=JSON.stringify(e.data).length),h(t)}),r(o,"fail",e=>{t.end_timestamp=Date.now(),t.network_error_msg=e.errMsg,h(t)}),wx.request(o)}},setTimeout(()=>{getApp().dem=e.exports},0),24===n.appKey.length?0!=n.domain.length?(a=n.domain,i=n.appKey.substring(0,8),p=n.appVersion||"",(()=>{const e=["debug","info","warn","error","log"];for(const t of e)r(console,t,(...e)=>{_({level:t,message:e[0]})})})(),setTimeout(y,1e4)):console.error("请正确设置 domain，不能为空"):console.error("请正确设置 appKey，长度为 24")},function(t,o){t.exports=e}])});